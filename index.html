<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workout Logger</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-dark: #0d0d0d;
            --bg-card: #1a1a1a;
            --bg-card-hover: #252525;
            --accent: #ff6b35;
            --accent-glow: rgba(255, 107, 53, 0.3);
            --success: #00d26a;
            --success-glow: rgba(0, 210, 106, 0.3);
            --warning: #ffd23f;
            --text: #ffffff;
            --text-muted: #888888;
            --border: #333333;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background:
                radial-gradient(ellipse at 20% 80%, var(--accent-glow) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 20%, var(--success-glow) 0%, transparent 50%),
                var(--bg-dark);
        }

        /* Header */
        header {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo-icon {
            font-size: 2rem;
        }

        .streak-badge {
            background: linear-gradient(135deg, var(--accent), #ff8c42);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Navigation */
        nav {
            background: var(--bg-card);
            padding: 1rem;
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            flex-wrap: wrap;
            border-bottom: 1px solid var(--border);
        }

        .nav-btn {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text);
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-btn:hover {
            border-color: var(--accent);
            background: rgba(255, 107, 53, 0.1);
        }

        .nav-btn.active {
            background: var(--accent);
            border-color: var(--accent);
            box-shadow: 0 0 20px var(--accent-glow);
        }

        /* Main Content */
        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: var(--accent);
            box-shadow: 0 0 30px rgba(255, 107, 53, 0.1);
        }

        .card-title {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Buttons */
        .btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px var(--accent-glow);
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid var(--accent);
            color: var(--accent);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-success:hover {
            box-shadow: 0 10px 30px var(--success-glow);
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        /* Body Part Selection */
        .body-parts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .body-part-btn {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .body-part-btn:hover {
            border-color: var(--accent);
            transform: translateY(-5px);
        }

        .body-part-btn.selected {
            border-color: var(--success);
            background: rgba(0, 210, 106, 0.1);
            box-shadow: 0 0 20px var(--success-glow);
        }

        .body-part-btn .icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .body-part-btn .icon svg {
            width: 60px;
            height: 60px;
            fill: var(--accent);
            transition: all 0.3s ease;
        }

        .body-part-btn:hover .icon svg {
            fill: var(--success);
            transform: scale(1.1);
        }

        .body-part-btn.selected .icon svg {
            fill: var(--success);
            filter: drop-shadow(0 0 10px var(--success-glow));
        }

        .body-part-btn .name {
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Exercise List */
        .exercise-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .exercise-btn {
            background: var(--bg-card-hover);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .exercise-btn:hover {
            border-color: var(--accent);
            background: rgba(255, 107, 53, 0.1);
        }

        .exercise-btn .muscle-tag {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        /* Form Inputs */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 1rem;
            border-radius: 12px;
            border: 2px solid var(--border);
            background: var(--bg-dark);
            color: var(--text);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 20px var(--accent-glow);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        /* Timer */
        .timer-display {
            font-size: 5rem;
            font-weight: bold;
            text-align: center;
            font-family: 'Courier New', monospace;
            color: var(--accent);
            text-shadow: 0 0 30px var(--accent-glow);
            margin: 2rem 0;
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .timer-preset {
            background: var(--bg-card-hover);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .timer-preset:hover, .timer-preset.active {
            border-color: var(--accent);
            background: rgba(255, 107, 53, 0.2);
        }

        /* Progress Bar */
        .progress-bar {
            height: 24px;
            background: var(--bg-dark);
            border-radius: 12px;
            overflow: hidden;
            margin: 0.5rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--success));
            border-radius: 12px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .stat-card {
            background: var(--bg-card-hover);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            border: 1px solid var(--border);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--accent);
        }

        .stat-label {
            color: var(--text-muted);
            margin-top: 0.5rem;
        }

        /* PR Celebration */
        .pr-celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-card);
            border: 3px solid var(--warning);
            border-radius: 24px;
            padding: 3rem;
            text-align: center;
            z-index: 1000;
            animation: prPop 0.5s ease;
            box-shadow: 0 0 100px rgba(255, 210, 63, 0.5);
        }

        @keyframes prPop {
            0% { transform: translate(-50%, -50%) scale(0); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        .pr-celebration .trophy {
            font-size: 5rem;
            animation: bounce 0.5s ease infinite alternate;
        }

        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-10px); }
        }

        .pr-celebration h2 {
            color: var(--warning);
            margin: 1rem 0;
            font-size: 2rem;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 999;
        }

        /* Workout Log */
        .workout-entry {
            background: var(--bg-card-hover);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border-left: 4px solid var(--accent);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .workout-entry .exercise-name {
            font-weight: bold;
        }

        .workout-entry .exercise-details {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .workout-entry .exercise-stats {
            text-align: right;
        }

        /* Food Grid */
        .food-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 0.75rem;
            max-height: 400px;
            overflow-y: auto;
            padding: 0.5rem;
        }

        .food-btn {
            background: var(--bg-card-hover);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .food-btn:hover {
            border-color: var(--success);
            background: rgba(0, 210, 106, 0.1);
        }

        .food-btn .food-name {
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .food-btn .food-cal {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .food-btn.custom {
            border-color: var(--warning);
        }

        /* Meal Log */
        .meal-entry {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: var(--bg-card-hover);
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }

        .meal-entry .calories {
            font-weight: bold;
            color: var(--success);
        }

        /* Chart */
        .chart-container {
            background: var(--bg-card-hover);
            border-radius: 16px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .chart-bars {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 200px;
            gap: 0.5rem;
            padding: 1rem 0;
        }

        .chart-bar {
            flex: 1;
            max-width: 60px;
            background: linear-gradient(180deg, var(--accent), var(--success));
            border-radius: 8px 8px 0 0;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .chart-bar:hover {
            filter: brightness(1.2);
        }

        .chart-bar .value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            font-weight: bold;
        }

        .chart-bar .label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: var(--text-muted);
            white-space: nowrap;
        }

        /* Session Summary */
        .session-summary {
            background: linear-gradient(135deg, var(--accent), #ff8c42);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            margin: 1rem 0;
        }

        .session-summary h2 {
            margin-bottom: 1rem;
        }

        .session-summary .big-number {
            font-size: 4rem;
            font-weight: bold;
        }

        /* Hidden */
        .hidden {
            display: none !important;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .timer-display {
                font-size: 3rem;
            }

            main {
                padding: 1rem;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <header>
        <div class="header-content">
            <div class="logo">
                <span class="logo-icon">üí™</span>
                <span>WORKOUT LOGGER</span>
            </div>
            <div class="streak-badge" id="streakBadge">
                <span>üî•</span>
                <span id="streakCount">0</span>
                <span>Day Streak</span>
            </div>
        </div>
    </header>

    <nav>
        <button class="nav-btn active" data-section="workout">üèãÔ∏è Workout</button>
        <button class="nav-btn" data-section="meal">üçΩÔ∏è Meal</button>
        <button class="nav-btn" data-section="progress">üìà Progress</button>
        <button class="nav-btn" data-section="summary">üìÖ Summary</button>
        <button class="nav-btn" data-section="timer">‚è±Ô∏è Timer</button>
    </nav>

    <main>
        <!-- WORKOUT SECTION -->
        <section id="workout" class="section active">
            <div class="card" id="workoutStart">
                <h2 class="card-title">üî• What are you hitting today?</h2>
                <div class="body-parts-grid" id="bodyPartsGrid">
                    <div class="body-part-btn" data-part="chest">
                        <div class="icon">
                            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                <!-- Chest/Pectorals -->
                                <ellipse cx="35" cy="45" rx="28" ry="22" opacity="0.9"/>
                                <ellipse cx="65" cy="45" rx="28" ry="22" opacity="0.9"/>
                                <ellipse cx="35" cy="42" rx="20" ry="14" fill="rgba(255,255,255,0.15)"/>
                                <ellipse cx="65" cy="42" rx="20" ry="14" fill="rgba(255,255,255,0.15)"/>
                                <path d="M50 25 L50 75" stroke="rgba(0,0,0,0.3)" stroke-width="2"/>
                                <circle cx="35" cy="55" r="3" fill="rgba(0,0,0,0.2)"/>
                                <circle cx="65" cy="55" r="3" fill="rgba(0,0,0,0.2)"/>
                            </svg>
                        </div>
                        <div class="name">Chest</div>
                    </div>
                    <div class="body-part-btn" data-part="back">
                        <div class="icon">
                            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                <!-- Back/Lats -->
                                <path d="M50 15 L30 35 L20 70 L35 85 L50 75 L65 85 L80 70 L70 35 Z" opacity="0.9"/>
                                <path d="M50 20 L50 70" stroke="rgba(0,0,0,0.3)" stroke-width="3"/>
                                <path d="M35 35 Q50 50 65 35" stroke="rgba(255,255,255,0.2)" stroke-width="3" fill="none"/>
                                <path d="M30 50 Q50 65 70 50" stroke="rgba(255,255,255,0.15)" stroke-width="2" fill="none"/>
                                <ellipse cx="35" cy="55" rx="12" ry="18" fill="rgba(255,255,255,0.1)"/>
                                <ellipse cx="65" cy="55" rx="12" ry="18" fill="rgba(255,255,255,0.1)"/>
                            </svg>
                        </div>
                        <div class="name">Back</div>
                    </div>
                    <div class="body-part-btn" data-part="shoulders">
                        <div class="icon">
                            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                <!-- Shoulders/Deltoids -->
                                <ellipse cx="20" cy="50" rx="18" ry="25" opacity="0.9"/>
                                <ellipse cx="80" cy="50" rx="18" ry="25" opacity="0.9"/>
                                <rect x="30" y="35" width="40" height="30" rx="5" opacity="0.7"/>
                                <ellipse cx="20" cy="45" rx="12" ry="15" fill="rgba(255,255,255,0.15)"/>
                                <ellipse cx="80" cy="45" rx="12" ry="15" fill="rgba(255,255,255,0.15)"/>
                                <path d="M20 30 Q20 25 25 25 L75 25 Q80 25 80 30" stroke="rgba(255,255,255,0.2)" stroke-width="3" fill="none"/>
                            </svg>
                        </div>
                        <div class="name">Shoulders</div>
                    </div>
                    <div class="body-part-btn" data-part="arms">
                        <div class="icon">
                            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                <!-- Bicep -->
                                <path d="M25 80 Q15 60 20 40 Q25 20 45 15 Q60 12 65 25 Q70 40 60 55 Q55 70 55 85 Z" opacity="0.9"/>
                                <ellipse cx="40" cy="40" rx="18" ry="22" fill="rgba(255,255,255,0.15)"/>
                                <path d="M30 35 Q45 25 55 35" stroke="rgba(255,255,255,0.2)" stroke-width="3" fill="none"/>
                                <ellipse cx="42" cy="70" rx="10" ry="8" fill="rgba(0,0,0,0.15)"/>
                                <!-- Vein detail -->
                                <path d="M35 30 Q40 50 38 65" stroke="rgba(0,0,0,0.1)" stroke-width="2" fill="none"/>
                            </svg>
                        </div>
                        <div class="name">Arms</div>
                    </div>
                    <div class="body-part-btn" data-part="core">
                        <div class="icon">
                            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                <!-- Abs/Core -->
                                <path d="M30 15 Q25 50 30 85 L70 85 Q75 50 70 15 Z" opacity="0.9"/>
                                <line x1="50" y1="18" x2="50" y2="82" stroke="rgba(0,0,0,0.4)" stroke-width="2"/>
                                <!-- 6-pack -->
                                <rect x="33" y="20" width="14" height="12" rx="3" fill="rgba(255,255,255,0.15)"/>
                                <rect x="53" y="20" width="14" height="12" rx="3" fill="rgba(255,255,255,0.15)"/>
                                <rect x="33" y="36" width="14" height="12" rx="3" fill="rgba(255,255,255,0.15)"/>
                                <rect x="53" y="36" width="14" height="12" rx="3" fill="rgba(255,255,255,0.15)"/>
                                <rect x="33" y="52" width="14" height="12" rx="3" fill="rgba(255,255,255,0.15)"/>
                                <rect x="53" y="52" width="14" height="12" rx="3" fill="rgba(255,255,255,0.15)"/>
                                <!-- Obliques -->
                                <path d="M30 68 Q35 75 32 82" stroke="rgba(0,0,0,0.2)" stroke-width="2" fill="none"/>
                                <path d="M70 68 Q65 75 68 82" stroke="rgba(0,0,0,0.2)" stroke-width="2" fill="none"/>
                            </svg>
                        </div>
                        <div class="name">Core</div>
                    </div>
                    <div class="body-part-btn" data-part="legs">
                        <div class="icon">
                            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                <!-- Quadriceps/Leg -->
                                <path d="M25 10 Q15 30 18 50 Q20 70 25 90 L45 90 Q50 70 48 50 Q45 30 50 10 Z" opacity="0.9"/>
                                <path d="M55 10 Q60 30 57 50 Q55 70 60 90 L80 90 Q85 70 82 50 Q80 30 75 10 Z" opacity="0.9"/>
                                <!-- Muscle definition -->
                                <ellipse cx="35" cy="40" rx="10" ry="20" fill="rgba(255,255,255,0.15)"/>
                                <ellipse cx="68" cy="40" rx="10" ry="20" fill="rgba(255,255,255,0.15)"/>
                                <path d="M30 55 Q35 70 33 85" stroke="rgba(0,0,0,0.2)" stroke-width="2" fill="none"/>
                                <path d="M70 55 Q68 70 72 85" stroke="rgba(0,0,0,0.2)" stroke-width="2" fill="none"/>
                                <!-- Knee area -->
                                <ellipse cx="35" cy="75" rx="8" ry="5" fill="rgba(0,0,0,0.1)"/>
                                <ellipse cx="68" cy="75" rx="8" ry="5" fill="rgba(0,0,0,0.1)"/>
                            </svg>
                        </div>
                        <div class="name">Legs</div>
                    </div>
                </div>
                <p style="color: var(--text-muted); text-align: center; margin-top: 1rem;">
                    Click one or two body parts to start your session
                </p>
                <div style="text-align: center; margin-top: 1rem;">
                    <button class="btn" id="startWorkoutBtn" disabled>Start Workout ‚Üí</button>
                </div>
            </div>

            <div class="card hidden" id="workoutSession">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2 class="card-title">üí™ <span id="sessionMuscles">Chest</span> Day</h2>
                    <span style="color: var(--text-muted);" id="exerciseCount">Exercise #1</span>
                </div>

                <div id="exerciseSelection">
                    <h3 style="margin-bottom: 1rem;">Select Exercise:</h3>
                    <div class="exercise-grid" id="exerciseGrid"></div>
                    <div style="margin-top: 1rem;">
                        <input type="text" id="customExercise" placeholder="Or type custom exercise name..." style="width: 100%; padding: 1rem; border-radius: 12px; border: 2px solid var(--border); background: var(--bg-dark); color: var(--text);">
                    </div>
                </div>

                <div class="hidden" id="exerciseForm">
                    <h3 style="margin-bottom: 1rem;">üìù <span id="selectedExerciseName"></span></h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Sets</label>
                            <input type="number" id="setsInput" min="1" value="3">
                        </div>
                        <div class="form-group">
                            <label>Reps</label>
                            <input type="number" id="repsInput" min="1" value="10">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Weight (kg)</label>
                            <input type="number" id="weightInput" min="0" step="0.5" placeholder="Optional">
                        </div>
                        <div class="form-group">
                            <label>Notes</label>
                            <input type="text" id="notesInput" placeholder="Optional">
                        </div>
                    </div>
                    <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                        <button class="btn" id="logExerciseBtn">‚úÖ Log Exercise</button>
                        <button class="btn btn-secondary" id="backToExercisesBtn">‚Üê Back</button>
                    </div>
                </div>

                <div id="sessionLog" style="margin-top: 2rem;">
                    <h3 style="margin-bottom: 1rem;">üìã Session Log</h3>
                    <div id="sessionLogEntries"></div>
                </div>

                <div style="display: flex; gap: 1rem; margin-top: 2rem; justify-content: center;">
                    <button class="btn btn-success" id="finishWorkoutBtn">üéâ Finish Workout</button>
                    <button class="btn btn-secondary" id="cancelWorkoutBtn">Cancel</button>
                </div>
            </div>

            <!-- Recent Workouts -->
            <div class="card">
                <h2 class="card-title">üìú Recent Workouts</h2>
                <div id="recentWorkouts"></div>
            </div>
        </section>

        <!-- MEAL SECTION -->
        <section id="meal" class="section">
            <div class="card">
                <h2 class="card-title">üçΩÔ∏è Log Your Meal</h2>
                <div class="food-grid" id="foodGrid"></div>
                <div style="margin-top: 1rem; display: flex; gap: 1rem;">
                    <input type="text" id="customFood" placeholder="Custom food name..." style="flex: 1; padding: 1rem; border-radius: 12px; border: 2px solid var(--border); background: var(--bg-dark); color: var(--text);">
                    <input type="number" id="customCalories" placeholder="Cal/100g" style="width: 120px; padding: 1rem; border-radius: 12px; border: 2px solid var(--border); background: var(--bg-dark); color: var(--text);">
                </div>
            </div>

            <div class="card hidden" id="mealForm">
                <h3 style="margin-bottom: 1rem;">ü•ó <span id="selectedFoodName"></span></h3>
                <div class="form-group">
                    <label>Amount (grams)</label>
                    <input type="number" id="gramsInput" min="1" value="100">
                </div>
                <p style="margin: 1rem 0; font-size: 1.5rem;">
                    Calories: <strong id="calculatedCalories" style="color: var(--success);">0</strong>
                </p>
                <div style="display: flex; gap: 1rem;">
                    <button class="btn btn-success" id="logMealBtn">‚úÖ Log Meal</button>
                    <button class="btn btn-secondary" id="cancelMealBtn">Cancel</button>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">üî• Today's Calories</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalCalories">0</div>
                        <div class="stat-label">Consumed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="remainingCalories">2000</div>
                        <div class="stat-label">Remaining</div>
                    </div>
                    <div class="stat-card" style="cursor: pointer;" id="goalCard" title="Click to change goal">
                        <div class="stat-value" id="calorieGoalDisplay">2000</div>
                        <div class="stat-label">Goal ‚úèÔ∏è</div>
                        <input type="number" id="calorieGoalInput" class="hidden" min="500" max="10000" step="100" style="width: 100%; padding: 0.5rem; border-radius: 8px; border: 2px solid var(--accent); background: var(--bg-dark); color: var(--text); font-size: 1.5rem; text-align: center; margin-top: 0.5rem;">
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="calorieProgress" style="width: 0%"></div>
                </div>
                <div id="todayMeals" style="margin-top: 1rem;"></div>
            </div>
        </section>

        <!-- PROGRESS SECTION -->
        <section id="progress" class="section">
            <div class="card">
                <h2 class="card-title">üèÜ Personal Records</h2>
                <div id="prList"></div>
            </div>

            <div class="card">
                <h2 class="card-title">üìä Progress Chart</h2>
                <div class="form-group">
                    <label>Select Exercise</label>
                    <select id="progressExerciseSelect">
                        <option value="">-- Select --</option>
                    </select>
                </div>
                <div class="chart-container" id="progressChart">
                    <p style="text-align: center; color: var(--text-muted);">Select an exercise to view progress</p>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">üìç Body Part Frequency</h2>
                <div id="frequencyChart"></div>
            </div>
        </section>

        <!-- SUMMARY SECTION -->
        <section id="summary" class="section">
            <div class="card">
                <h2 class="card-title">üìÖ Weekly Summary</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="weekSessions">0</div>
                        <div class="stat-label">Workout Days</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="weekExercises">0</div>
                        <div class="stat-label">Exercises</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="weekCalories">0</div>
                        <div class="stat-label">Avg Calories</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">üèãÔ∏è This Week's Workouts</h2>
                <div id="weeklyBodyParts"></div>
            </div>

            <div class="card">
                <h2 class="card-title">üçΩÔ∏è Top Foods This Week</h2>
                <div id="weeklyFoods"></div>
            </div>
        </section>

        <!-- TIMER SECTION -->
        <section id="timer" class="section">
            <div class="card" style="text-align: center;">
                <h2 class="card-title" style="justify-content: center;">‚è±Ô∏è Rest Timer</h2>
                <div class="timer-display" id="timerDisplay">1:30</div>
                <div class="timer-controls">
                    <button class="timer-preset" data-time="30">30s</button>
                    <button class="timer-preset" data-time="60">1:00</button>
                    <button class="timer-preset active" data-time="90">1:30</button>
                    <button class="timer-preset" data-time="120">2:00</button>
                    <button class="timer-preset" data-time="180">3:00</button>
                </div>
                <div style="margin-top: 1.5rem; display: flex; align-items: center; justify-content: center; gap: 1rem;">
                    <label style="color: var(--text-muted);">Custom:</label>
                    <input type="number" id="customTimerInput" min="5" max="600" placeholder="seconds" style="width: 100px; padding: 0.75rem; border-radius: 12px; border: 2px solid var(--border); background: var(--bg-dark); color: var(--text); font-size: 1rem; text-align: center;">
                    <button class="btn btn-small btn-secondary" id="setCustomTimerBtn">Set</button>
                </div>
                <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: center;">
                    <button class="btn btn-success" id="startTimerBtn">‚ñ∂Ô∏è Start</button>
                    <button class="btn btn-secondary" id="resetTimerBtn">üîÑ Reset</button>
                </div>
            </div>
        </section>
    </main>

    <!-- PR Celebration Modal -->
    <div class="overlay hidden" id="prOverlay"></div>
    <div class="pr-celebration hidden" id="prModal">
        <div class="trophy">üèÜ</div>
        <h2>NEW PR!</h2>
        <p id="prMessage"></p>
        <button class="btn" style="margin-top: 1rem;" id="closePrBtn">AWESOME! üí™</button>
    </div>

    <script>
        // ============================================
        // DATA
        // ============================================
        const BODY_PARTS = {
            chest: ["Bench Press", "Push-ups", "Dumbbell Fly", "Incline Press", "Cable Crossover"],
            back: ["Pull-ups", "Deadlift", "Barbell Row", "Lat Pulldown", "Seated Row"],
            shoulders: ["Overhead Press", "Lateral Raise", "Front Raise", "Face Pull", "Shrugs"],
            arms: ["Bicep Curl", "Tricep Dip", "Hammer Curl", "Skull Crusher", "Cable Pushdown"],
            core: ["Plank", "Crunches", "Leg Raise", "Russian Twist", "Mountain Climbers"],
            legs: ["Squat", "Lunges", "Leg Press", "Calf Raise", "Romanian Deadlift"]
        };

        const FOOD_DATABASE = {
            "Chicken Breast": 165, "Eggs": 155, "Salmon": 208, "Beef": 250, "Turkey": 135,
            "Rice": 130, "Oatmeal": 68, "Bread": 265, "Pasta": 131, "Potato": 77,
            "Broccoli": 34, "Spinach": 23, "Banana": 89, "Apple": 52,
            "Greek Yogurt": 97, "Milk": 42, "Cheese": 402,
            "Protein Shake": 120, "Almonds": 579, "Peanut Butter": 588
        };

        // Load from localStorage
        let workouts = JSON.parse(localStorage.getItem('workouts') || '[]');
        let meals = JSON.parse(localStorage.getItem('meals') || '[]');
        let customFoods = JSON.parse(localStorage.getItem('customFoods') || '{}');

        // Current session state
        let selectedParts = [];
        let currentExercise = null;
        let currentExerciseMuscle = null;
        let sessionWorkouts = [];
        let selectedFood = null;
        let selectedFoodCalories = 0;

        // Calorie goal (customizable)
        let calorieGoal = parseInt(localStorage.getItem('calorieGoal')) || 2000;

        // Timer state
        let timerSeconds = 90;
        let timerInterval = null;
        let isTimerRunning = false;

        // ============================================
        // NAVIGATION
        // ============================================
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.getElementById(btn.dataset.section).classList.add('active');

                // Refresh data when switching sections
                if (btn.dataset.section === 'progress') updateProgressSection();
                if (btn.dataset.section === 'summary') updateSummarySection();
                if (btn.dataset.section === 'meal') updateMealSection();
                if (btn.dataset.section === 'workout') updateRecentWorkouts();
            });
        });

        // ============================================
        // WORKOUT FUNCTIONS
        // ============================================
        document.querySelectorAll('.body-part-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const part = btn.dataset.part;
                if (selectedParts.includes(part)) {
                    selectedParts = selectedParts.filter(p => p !== part);
                    btn.classList.remove('selected');
                } else if (selectedParts.length < 2) {
                    selectedParts.push(part);
                    btn.classList.add('selected');
                }
                document.getElementById('startWorkoutBtn').disabled = selectedParts.length === 0;
            });
        });

        document.getElementById('startWorkoutBtn').addEventListener('click', () => {
            document.getElementById('workoutStart').classList.add('hidden');
            document.getElementById('workoutSession').classList.remove('hidden');
            document.getElementById('sessionMuscles').textContent = selectedParts.map(p => p.charAt(0).toUpperCase() + p.slice(1)).join(' + ');
            sessionWorkouts = [];
            updateExerciseGrid();
            updateExerciseCount();
        });

        function updateExerciseGrid() {
            const grid = document.getElementById('exerciseGrid');
            grid.innerHTML = '';
            selectedParts.forEach(part => {
                BODY_PARTS[part].forEach(ex => {
                    const btn = document.createElement('div');
                    btn.className = 'exercise-btn';
                    btn.innerHTML = `<div>${ex}</div><div class="muscle-tag">${part}</div>`;
                    btn.addEventListener('click', () => selectExercise(ex, part));
                    grid.appendChild(btn);
                });
            });
        }

        document.getElementById('customExercise').addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && e.target.value.trim()) {
                selectExercise(e.target.value.trim(), selectedParts[0]);
                e.target.value = '';
            }
        });

        function selectExercise(name, muscle) {
            currentExercise = name;
            currentExerciseMuscle = muscle;
            document.getElementById('selectedExerciseName').textContent = name;
            document.getElementById('exerciseSelection').classList.add('hidden');
            document.getElementById('exerciseForm').classList.remove('hidden');
        }

        document.getElementById('backToExercisesBtn').addEventListener('click', () => {
            document.getElementById('exerciseSelection').classList.remove('hidden');
            document.getElementById('exerciseForm').classList.add('hidden');
        });

        document.getElementById('logExerciseBtn').addEventListener('click', () => {
            const sets = parseInt(document.getElementById('setsInput').value) || 3;
            const reps = parseInt(document.getElementById('repsInput').value) || 10;
            const weight = parseFloat(document.getElementById('weightInput').value) || 0;
            const notes = document.getElementById('notesInput').value;

            // Check for PR
            const isPR = checkPR(currentExercise, weight);

            const workout = {
                date: new Date().toISOString(),
                bodyPart: currentExerciseMuscle,
                exercise: currentExercise,
                sets, reps, weight, notes,
                sessionMuscles: [...selectedParts]
            };

            sessionWorkouts.push(workout);
            updateSessionLog();
            updateExerciseCount();

            // Show PR celebration
            if (isPR && weight > 0) {
                showPRCelebration(currentExercise, weight);
            }

            // Reset form
            document.getElementById('exerciseSelection').classList.remove('hidden');
            document.getElementById('exerciseForm').classList.add('hidden');
            document.getElementById('weightInput').value = '';
            document.getElementById('notesInput').value = '';
        });

        function checkPR(exercise, newWeight) {
            if (!newWeight) return false;
            const previousWorkouts = workouts.filter(w => w.exercise.toLowerCase() === exercise.toLowerCase());
            const maxWeight = Math.max(0, ...previousWorkouts.map(w => w.weight || 0));
            return newWeight > maxWeight;
        }

        function showPRCelebration(exercise, weight) {
            document.getElementById('prMessage').textContent = `${exercise}: ${weight}kg`;
            document.getElementById('prOverlay').classList.remove('hidden');
            document.getElementById('prModal').classList.remove('hidden');
        }

        document.getElementById('closePrBtn').addEventListener('click', () => {
            document.getElementById('prOverlay').classList.add('hidden');
            document.getElementById('prModal').classList.add('hidden');
        });

        document.getElementById('prOverlay').addEventListener('click', () => {
            document.getElementById('prOverlay').classList.add('hidden');
            document.getElementById('prModal').classList.add('hidden');
        });

        function updateSessionLog() {
            const container = document.getElementById('sessionLogEntries');
            container.innerHTML = sessionWorkouts.map(w => `
                <div class="workout-entry">
                    <div>
                        <div class="exercise-name">${w.exercise}</div>
                        <div class="exercise-details">${w.bodyPart}${w.notes ? ' ‚Ä¢ ' + w.notes : ''}</div>
                    </div>
                    <div class="exercise-stats">
                        <div>${w.sets}x${w.reps}</div>
                        ${w.weight ? `<div style="color: var(--accent);">${w.weight}kg</div>` : ''}
                    </div>
                </div>
            `).join('');
        }

        function updateExerciseCount() {
            document.getElementById('exerciseCount').textContent = `Exercise #${sessionWorkouts.length + 1}`;
        }

        document.getElementById('finishWorkoutBtn').addEventListener('click', () => {
            if (sessionWorkouts.length === 0) {
                alert('Log at least one exercise first!');
                return;
            }
            workouts = [...workouts, ...sessionWorkouts];
            localStorage.setItem('workouts', JSON.stringify(workouts));

            alert(`Great session! Logged ${sessionWorkouts.length} exercises! üí™`);
            resetWorkoutUI();
            updateStreak();
            updateRecentWorkouts();
        });

        document.getElementById('cancelWorkoutBtn').addEventListener('click', resetWorkoutUI);

        function resetWorkoutUI() {
            document.getElementById('workoutStart').classList.remove('hidden');
            document.getElementById('workoutSession').classList.add('hidden');
            document.querySelectorAll('.body-part-btn').forEach(b => b.classList.remove('selected'));
            selectedParts = [];
            sessionWorkouts = [];
            document.getElementById('startWorkoutBtn').disabled = true;
            document.getElementById('sessionLogEntries').innerHTML = '';
        }

        function updateRecentWorkouts() {
            const container = document.getElementById('recentWorkouts');
            const recent = workouts.slice(-10).reverse();
            if (recent.length === 0) {
                container.innerHTML = '<p style="color: var(--text-muted);">No workouts logged yet</p>';
                return;
            }
            container.innerHTML = recent.map(w => `
                <div class="workout-entry">
                    <div>
                        <div class="exercise-name">${w.exercise}</div>
                        <div class="exercise-details">${w.bodyPart} ‚Ä¢ ${new Date(w.date).toLocaleDateString()}</div>
                    </div>
                    <div class="exercise-stats">
                        <div>${w.sets}x${w.reps}</div>
                        ${w.weight ? `<div style="color: var(--accent);">${w.weight}kg</div>` : ''}
                    </div>
                </div>
            `).join('');
        }

        // ============================================
        // MEAL FUNCTIONS
        // ============================================
        function updateMealSection() {
            const grid = document.getElementById('foodGrid');
            const allFoods = {...FOOD_DATABASE, ...customFoods};
            grid.innerHTML = Object.entries(allFoods).map(([name, cal]) => `
                <div class="food-btn ${customFoods[name] ? 'custom' : ''}" data-food="${name}" data-cal="${cal}">
                    <div class="food-name">${name}</div>
                    <div class="food-cal">${cal} cal/100g</div>
                </div>
            `).join('');

            grid.querySelectorAll('.food-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    selectedFood = btn.dataset.food;
                    selectedFoodCalories = parseInt(btn.dataset.cal);
                    document.getElementById('selectedFoodName').textContent = selectedFood;
                    document.getElementById('mealForm').classList.remove('hidden');
                    updateCalculatedCalories();
                });
            });

            updateTodayCalories();
        }

        document.getElementById('gramsInput').addEventListener('input', updateCalculatedCalories);

        function updateCalculatedCalories() {
            const grams = parseInt(document.getElementById('gramsInput').value) || 0;
            const calories = Math.round((grams / 100) * selectedFoodCalories);
            document.getElementById('calculatedCalories').textContent = calories;
        }

        document.getElementById('logMealBtn').addEventListener('click', () => {
            const grams = parseInt(document.getElementById('gramsInput').value) || 100;
            const calories = Math.round((grams / 100) * selectedFoodCalories);

            const meal = {
                date: new Date().toISOString().split('T')[0],
                time: new Date().toTimeString().slice(0, 5),
                food: selectedFood,
                grams,
                calories
            };

            meals.push(meal);
            localStorage.setItem('meals', JSON.stringify(meals));

            document.getElementById('mealForm').classList.add('hidden');
            updateTodayCalories();
        });

        document.getElementById('cancelMealBtn').addEventListener('click', () => {
            document.getElementById('mealForm').classList.add('hidden');
        });

        // Custom food
        document.getElementById('customFood').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const name = document.getElementById('customFood').value.trim();
                const cal = parseInt(document.getElementById('customCalories').value);
                if (name && cal > 0) {
                    customFoods[name] = cal;
                    localStorage.setItem('customFoods', JSON.stringify(customFoods));
                    document.getElementById('customFood').value = '';
                    document.getElementById('customCalories').value = '';
                    updateMealSection();
                }
            }
        });

        function updateTodayCalories() {
            const today = new Date().toISOString().split('T')[0];
            const todayMeals = meals.filter(m => m.date === today);
            const total = todayMeals.reduce((sum, m) => sum + m.calories, 0);
            document.getElementById('totalCalories').textContent = total;
            document.getElementById('remainingCalories').textContent = Math.max(0, calorieGoal - total);
            document.getElementById('calorieGoalDisplay').textContent = calorieGoal;
            document.getElementById('calorieProgress').style.width = Math.min(100, (total / calorieGoal) * 100) + '%';

            const container = document.getElementById('todayMeals');
            container.innerHTML = todayMeals.map(m => `
                <div class="meal-entry">
                    <div>
                        <strong>${m.food}</strong>
                        <span style="color: var(--text-muted);"> ‚Ä¢ ${m.grams}g</span>
                    </div>
                    <div class="calories">${m.calories} cal</div>
                </div>
            `).join('');
        }

        // ============================================
        // PROGRESS FUNCTIONS
        // ============================================
        function updateProgressSection() {
            // PRs
            const prList = document.getElementById('prList');
            const exerciseMap = {};
            workouts.forEach(w => {
                if (w.weight) {
                    if (!exerciseMap[w.exercise] || w.weight > exerciseMap[w.exercise].weight) {
                        exerciseMap[w.exercise] = w;
                    }
                }
            });

            if (Object.keys(exerciseMap).length === 0) {
                prList.innerHTML = '<p style="color: var(--text-muted);">No PRs yet - log weighted exercises!</p>';
            } else {
                prList.innerHTML = Object.values(exerciseMap).map(w => `
                    <div class="workout-entry">
                        <div>
                            <div class="exercise-name">üèÜ ${w.exercise}</div>
                            <div class="exercise-details">${new Date(w.date).toLocaleDateString()}</div>
                        </div>
                        <div class="exercise-stats">
                            <div style="font-size: 1.25rem; color: var(--warning);">${w.weight}kg</div>
                            <div>${w.sets}x${w.reps}</div>
                        </div>
                    </div>
                `).join('');
            }

            // Exercise select for chart
            const select = document.getElementById('progressExerciseSelect');
            const exercises = [...new Set(workouts.filter(w => w.weight).map(w => w.exercise))];
            select.innerHTML = '<option value="">-- Select --</option>' + exercises.map(e => `<option value="${e}">${e}</option>`).join('');

            // Frequency chart
            updateFrequencyChart();
        }

        document.getElementById('progressExerciseSelect').addEventListener('change', (e) => {
            if (e.target.value) {
                showProgressChart(e.target.value);
            }
        });

        function showProgressChart(exercise) {
            const container = document.getElementById('progressChart');
            const exerciseWorkouts = workouts.filter(w => w.exercise === exercise && w.weight).slice(-10);

            if (exerciseWorkouts.length < 2) {
                container.innerHTML = '<p style="text-align: center; color: var(--text-muted);">Need at least 2 records</p>';
                return;
            }

            const maxWeight = Math.max(...exerciseWorkouts.map(w => w.weight));
            container.innerHTML = `
                <div class="chart-bars">
                    ${exerciseWorkouts.map(w => {
                        const height = (w.weight / maxWeight) * 100;
                        return `
                            <div class="chart-bar" style="height: ${height}%;">
                                <span class="value">${w.weight}kg</span>
                                <span class="label">${new Date(w.date).toLocaleDateString().slice(0, 5)}</span>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function updateFrequencyChart() {
            const container = document.getElementById('frequencyChart');
            const counts = {};
            workouts.forEach(w => {
                counts[w.bodyPart] = (counts[w.bodyPart] || 0) + 1;
            });

            if (Object.keys(counts).length === 0) {
                container.innerHTML = '<p style="color: var(--text-muted);">No workout data yet</p>';
                return;
            }

            const max = Math.max(...Object.values(counts));
            container.innerHTML = Object.entries(counts)
                .sort((a, b) => b[1] - a[1])
                .map(([part, count]) => `
                    <div style="margin-bottom: 1rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span style="text-transform: capitalize;">${part}</span>
                            <span style="color: var(--accent);">${count}</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${(count / max) * 100}%"></div>
                        </div>
                    </div>
                `).join('');
        }

        // ============================================
        // SUMMARY FUNCTIONS
        // ============================================
        function updateSummarySection() {
            const weekAgo = new Date();
            weekAgo.setDate(weekAgo.getDate() - 7);

            const weekWorkouts = workouts.filter(w => new Date(w.date) >= weekAgo);
            const weekMeals = meals.filter(m => new Date(m.date) >= weekAgo);

            // Stats
            const uniqueDays = new Set(weekWorkouts.map(w => w.date.split('T')[0])).size;
            document.getElementById('weekSessions').textContent = uniqueDays;
            document.getElementById('weekExercises').textContent = weekWorkouts.length;

            const mealDays = new Set(weekMeals.map(m => m.date)).size;
            const totalCal = weekMeals.reduce((sum, m) => sum + m.calories, 0);
            document.getElementById('weekCalories').textContent = mealDays > 0 ? Math.round(totalCal / mealDays) : 0;

            // Body parts
            const bodyPartCounts = {};
            weekWorkouts.forEach(w => {
                bodyPartCounts[w.bodyPart] = (bodyPartCounts[w.bodyPart] || 0) + 1;
            });

            const bpContainer = document.getElementById('weeklyBodyParts');
            if (Object.keys(bodyPartCounts).length === 0) {
                bpContainer.innerHTML = '<p style="color: var(--text-muted);">No workouts this week</p>';
            } else {
                const max = Math.max(...Object.values(bodyPartCounts));
                bpContainer.innerHTML = Object.entries(bodyPartCounts)
                    .sort((a, b) => b[1] - a[1])
                    .map(([part, count]) => `
                        <div style="margin-bottom: 1rem;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span style="text-transform: capitalize;">${part}</span>
                                <span>${count}x</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${(count / max) * 100}%"></div>
                            </div>
                        </div>
                    `).join('');
            }

            // Foods
            const foodCounts = {};
            weekMeals.forEach(m => {
                foodCounts[m.food] = (foodCounts[m.food] || 0) + 1;
            });

            const foodContainer = document.getElementById('weeklyFoods');
            if (Object.keys(foodCounts).length === 0) {
                foodContainer.innerHTML = '<p style="color: var(--text-muted);">No meals this week</p>';
            } else {
                foodContainer.innerHTML = Object.entries(foodCounts)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 5)
                    .map(([food, count], i) => `
                        <div class="meal-entry">
                            <div><strong>${i + 1}. ${food}</strong></div>
                            <div style="color: var(--accent);">${count}x</div>
                        </div>
                    `).join('');
            }
        }

        // ============================================
        // TIMER FUNCTIONS
        // ============================================
        document.querySelectorAll('.timer-preset').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.timer-preset').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                timerSeconds = parseInt(btn.dataset.time);
                updateTimerDisplay();
                if (isTimerRunning) {
                    clearInterval(timerInterval);
                    isTimerRunning = false;
                    document.getElementById('startTimerBtn').textContent = '‚ñ∂Ô∏è Start';
                }
            });
        });

        document.getElementById('startTimerBtn').addEventListener('click', () => {
            if (isTimerRunning) {
                clearInterval(timerInterval);
                isTimerRunning = false;
                document.getElementById('startTimerBtn').textContent = '‚ñ∂Ô∏è Start';
            } else {
                isTimerRunning = true;
                document.getElementById('startTimerBtn').textContent = '‚è∏Ô∏è Pause';
                timerInterval = setInterval(() => {
                    timerSeconds--;
                    updateTimerDisplay();
                    if (timerSeconds <= 0) {
                        clearInterval(timerInterval);
                        isTimerRunning = false;
                        document.getElementById('startTimerBtn').textContent = '‚ñ∂Ô∏è Start';
                        // Play sound or notification
                        alert("‚è∞ Time's up! Get back to work! üí™");
                    }
                }, 1000);
            }
        });

        document.getElementById('resetTimerBtn').addEventListener('click', () => {
            clearInterval(timerInterval);
            isTimerRunning = false;
            timerSeconds = parseInt(document.querySelector('.timer-preset.active').dataset.time);
            updateTimerDisplay();
            document.getElementById('startTimerBtn').textContent = '‚ñ∂Ô∏è Start';
        });

        function updateTimerDisplay() {
            const mins = Math.floor(timerSeconds / 60);
            const secs = timerSeconds % 60;
            document.getElementById('timerDisplay').textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // ============================================
        // STREAK CALCULATION
        // ============================================
        function calculateStreak() {
            if (workouts.length === 0) return 0;

            const dates = [...new Set(workouts.map(w => w.date.split('T')[0]))].sort().reverse();
            const today = new Date().toISOString().split('T')[0];
            const yesterday = new Date(Date.now() - 86400000).toISOString().split('T')[0];

            if (dates[0] !== today && dates[0] !== yesterday) return 0;

            let streak = 1;
            for (let i = 0; i < dates.length - 1; i++) {
                const current = new Date(dates[i]);
                const prev = new Date(dates[i + 1]);
                const diff = (current - prev) / 86400000;
                if (diff === 1) streak++;
                else break;
            }
            return streak;
        }

        function updateStreak() {
            const streak = calculateStreak();
            document.getElementById('streakCount').textContent = streak;
            if (streak === 0) {
                document.getElementById('streakBadge').style.display = 'none';
            } else {
                document.getElementById('streakBadge').style.display = 'flex';
            }
        }

        // ============================================
        // CUSTOM CALORIE GOAL
        // ============================================
        document.getElementById('goalCard').addEventListener('click', () => {
            const display = document.getElementById('calorieGoalDisplay');
            const input = document.getElementById('calorieGoalInput');

            if (input.classList.contains('hidden')) {
                input.classList.remove('hidden');
                input.value = calorieGoal;
                input.focus();
                input.select();
            }
        });

        document.getElementById('calorieGoalInput').addEventListener('blur', updateCalorieGoal);
        document.getElementById('calorieGoalInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') updateCalorieGoal();
        });

        function updateCalorieGoal() {
            const input = document.getElementById('calorieGoalInput');
            const newGoal = parseInt(input.value);

            if (newGoal && newGoal >= 500 && newGoal <= 10000) {
                calorieGoal = newGoal;
                localStorage.setItem('calorieGoal', calorieGoal);
                updateTodayCalories();
            }
            input.classList.add('hidden');
        }

        // ============================================
        // CUSTOM TIMER
        // ============================================
        document.getElementById('setCustomTimerBtn').addEventListener('click', setCustomTimer);
        document.getElementById('customTimerInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') setCustomTimer();
        });

        function setCustomTimer() {
            const input = document.getElementById('customTimerInput');
            const seconds = parseInt(input.value);

            if (seconds && seconds >= 5 && seconds <= 600) {
                // Remove active from presets
                document.querySelectorAll('.timer-preset').forEach(b => b.classList.remove('active'));

                timerSeconds = seconds;
                updateTimerDisplay();

                if (isTimerRunning) {
                    clearInterval(timerInterval);
                    isTimerRunning = false;
                    document.getElementById('startTimerBtn').textContent = '‚ñ∂Ô∏è Start';
                }

                input.value = '';
            } else {
                alert('Please enter a time between 5 and 600 seconds');
            }
        }

        // ============================================
        // INIT
        // ============================================
        updateStreak();
        updateRecentWorkouts();
        updateMealSection();
    </script>
</body>
</html>
